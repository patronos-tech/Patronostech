<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Patronos Tech • Produtos (Serviços Executados)</title>

<!-- Fonts + preload LCP -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<link rel="preload" as="image" href="assets/images/hero-eletrica.png">

<style>
:root{
  --bg-1:#071226;
  --card:#0b1320;
  --gold:#d4af37;
  --muted:#c8cad0;
  --white:#fff;
  --maxw:1120px;
  --gap:18px;
  --radius:12px;
  --shadow:0 12px 36px rgba(0,0,0,.55);
}

/* Base */
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:Poppins,system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;background:linear-gradient(180deg,var(--bg-1),#03121b);color:var(--white);-webkit-font-smoothing:antialiased}
.container{max-width:var(--maxw);margin:0 auto;padding:0 18px 48px}

/* Header / menu shared with index */
header{position:sticky;top:0;background:rgba(2,6,12,.88);backdrop-filter:saturate(.9) blur(6px);z-index:140;padding:10px 0}
.header-inner{display:flex;align-items:center;justify-content:space-between}
.logo{font-weight:800;font-size:22px;background:linear-gradient(90deg,#fff,var(--gold));-webkit-background-clip:text;color:transparent}
.menu-btn{font-size:26px;background:transparent;border:0;color:var(--muted);padding:8px;border-radius:8px;cursor:pointer}
.menu-btn:focus{outline:2px solid rgba(212,175,55,.18);outline-offset:3px}

/* Off-canvas menu (unificado) */
#sideMenu{position:fixed;top:0;right:0;width:320px;max-width:86%;height:100%;background:#02061a;padding:18px;transform:translateX(100%);transition:transform .32s ease;box-shadow:-10px 0 40px rgba(0,0,0,.6);z-index:999}
#sideMenu.open{transform:translateX(0)}
#sideMenu a{display:block;color:var(--muted);padding:12px 0;text-decoration:none;border-bottom:1px solid rgba(255,255,255,.03)}
#sideMenu a:first-child{text-align:right}

/* Hero */
.hero{position:relative;margin-top:14px;border-radius:10px;overflow:hidden}
.hero img{width:100%;height:min(58vh,560px);object-fit:cover;object-position:center center;display:block}
.hero-overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:28px;background:linear-gradient(180deg, rgba(2,8,18,0.18), rgba(2,8,18,0.56));}
.hero-content{max-width:980px;width:100%;padding:10px 18px;text-align:center}
.page-title{font-size:1.7rem;font-weight:700}
.lead{margin-top:10px;color:rgba(255,255,255,.9);font-size:1rem;max-width:72ch;margin-left:auto;margin-right:auto}
.hero-ctas{margin-top:16px;display:flex;gap:12px;flex-wrap:wrap;justify-content:center}

/* Buttons */
.btn{display:inline-block;padding:10px 16px;border-radius:10px;background:var(--gold);color:#000;font-weight:700;text-decoration:none}
.btn.alt{background:transparent;border:1px solid rgba(212,175,55,.12);color:var(--gold)}

/* Sections */
.section{padding:36px 0}
.section h2{text-align:center;color:var(--gold);margin:0 0 8px;font-size:1.15rem}
.section p.lead{max-width:980px;margin:8px auto 20px;text-align:center;color:var(--muted);font-size:1rem}

/* Carousel common */
.carousel{position:relative;overflow:hidden;margin:18px 0;padding:8px 0}
.track{display:flex;gap:var(--gap);align-items:stretch;will-change:transform;padding:8px}
.card{background:var(--card);border-radius:12px;padding:14px;min-width:260px;flex:0 0 260px;box-shadow:var(--shadow);display:flex;flex-direction:column;align-items:center;text-align:center}
.card img{width:100%;height:150px;object-fit:cover;border-radius:8px}
.card h3{margin:12px 0 8px;color:var(--gold);font-size:1.05rem}
.card p{margin:0;color:var(--muted);font-size:0.95rem;line-height:1.35}

/* product card specific */
.prod-card{min-width:220px;flex:0 0 220px}
.prod-card .meta{color:var(--muted);font-size:0.9rem;margin-top:8px}

/* controls/indicators */
.controls{position:absolute;top:50%;left:6px;right:6px;display:flex;justify-content:space-between;transform:translateY(-50%);pointer-events:none}
.ctrl{pointer-events:auto;background:rgba(0,0,0,.36);border:0;color:var(--white);width:44px;height:44px;border-radius:8px;display:flex;align-items:center;justify-content:center;cursor:pointer}
ctrl:focus{outline:2px solid rgba(212,175,55,.18)}
.indicators{display:flex;gap:8px;justify-content:center;margin-top:12px}
.indicators button{width:10px;height:10px;border-radius:50%;border:0;background:rgba(255,255,255,.12);cursor:pointer}
.indicators button.active{background:var(--gold)}

/* Testimonials */
.testimonials{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);padding:28px;border-radius:12px;margin-top:24px}
.testimonial{background:var(--card);padding:16px;border-radius:10px;margin:8px 0;color:var(--muted)}

/* Footer */
footer{padding:28px 0;text-align:center;color:var(--muted);font-size:13px}

/* Responsive */
@media (max-width:900px){
  .card{min-width:220px;flex:0 0 220px}
  .hero h1{font-size:1.35rem}
}
@media (max-width:600px){
  .container{padding:0 14px 48px}
  .card{min-width:86vw;flex:0 0 86vw;border-radius:10px}
  .controls{display:none}
  .hero h1{font-size:1.05rem}
}
</style>
</head>
<body>

<header>
  <div class="container header-inner">
    <div class="logo">Patronos Tech</div>
    <button id="menuBtn" class="menu-btn" aria-controls="sideMenu" aria-expanded="false" aria-label="Abrir menu">☰</button>
  </div>
</header>

<nav id="sideMenu" aria-hidden="true" aria-label="Menu principal">
  <a id="closeMenu" href="javascript:void(0)">✕ Fechar</a>
  <a href="products.html">Serviços</a>
  <a href="index.html#servicos-tecnicos">Serviços Técnicos</a>
  <a href="products.html#eletrica">Elétrica</a>
  <a href="products.html#cftv">CFTV</a>
  <a href="products.html#telecom">Telecom</a>
  <a href="products.html#automacao">Automação</a>
  <a href="products.html#ar-condicionado">Ar Condicionado</a>
  <a href="products.html#manutencao-geral">Manutenção Geral</a>
  <a href="products.html#marido">Marido de aluguel</a>
  <a href="parcerias.html">Parcerias</a>
  <a href="https://wa.me/5511952544885">Contatos</a>
</nav>

<main class="container">

  <!-- HERO -->
  <section class="hero" aria-label="Hero produtos">
    <img src="assets/images/hero-eletrica.png" alt="Técnico realizando instalação">
    <div class="hero-overlay" role="region" aria-label="Hero - Produtos">
      <div class="hero-content">
        <h1 class="page-title">Produtos</h1>
        <div class="lead">Serviços executados e procedimentos — escolha a categoria e solicite um orçamento rápido pelo WhatsApp.</div>
        <div class="hero-ctas">
          <a class="btn" href="https://wa.me/5511952544885?text=Olá,+gostaria+de+um+orçamento">Orçar agora (WhatsApp)</a>
          <a class="btn alt" href="#servicos-principais">Ver principais</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Carousel 1: Todos os principais serviços (broad highlights) -->
  <section class="section" aria-label="Principais serviços">
    <h2 class="category-title">Principais Serviços</h2>
    <p class="lead">Os serviços mais procurados e relevantes — clique para pedir orçamento.</p>

    <div class="carousel" data-speed="40" aria-roledescription="carousel" aria-label="Principais serviços">
      <div class="controls" aria-hidden="true">
        <button class="ctrl prev" data-target="primary-services" aria-label="Anterior">‹</button>
        <button class="ctrl next" data-target="primary-services" aria-label="Próximo">›</button>
      </div>

      <div class="track" data-track="primary-services" role="list">
        <!-- Service cards (broad) -->
        <article class="card" role="group" aria-label="Instalações técnicas">
          <img src="assets/images/servico-eletrica.jpg" alt="Instalações técnicas">
          <h3>Instalações Técnicas</h3>
          <p>Projeto e execução de instalações elétricas, cabeamento e CFTV com documentação técnica.</p>
          <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Instalações+Técnicas">Orçar no WhatsApp</a>
        </article>

        <article class="card" role="group" aria-label="Manutenção">
          <img src="assets/images/servico-geral.jpeg" alt="Manutenção">
          <h3>Manutenção Geral</h3>
          <p>Planos preventivos e intervenções corretivas para manter equipamentos e instalações funcionando.</p>
          <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Manutenção+Geral">Orçar no WhatsApp</a>
        </article>

        <article class="card" role="group" aria-label="Marido de aluguel">
          <img src="assets/images/servico-manut.jpeg" alt="Marido de aluguel">
          <h3>Marido de Aluguel</h3>
          <p>Pequenos reparos, montagem e serviços rápidos para quem precisa de solução imediata.</p>
          <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Marido+de+Aluguel">Orçar no WhatsApp</a>
        </article>

        <article class="card" role="group" aria-label="Automação e controle">
          <img src="assets/images/servico-automacao.jpg" alt="Automação">
          <h3>Automação</h3>
          <p>Integração de sistemas e cenários de controle para conforto e eficiência energética.</p>
          <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Automação">Orçar no WhatsApp</a>
        </article>

        <article class="card" role="group" aria-label="CFTV e segurança">
          <img src="assets/images/servico-cftv.jpg" alt="CFTV">
          <h3>CFTV</h3>
          <p>Projeto e instalação de sistemas de vídeo para monitoramento e controle de acesso.</p>
          <a class="btn" href="https://wa.me/5511952544885?text=Orçar+CFTV">Orçar no WhatsApp</a>
        </article>

        <article class="card" role="group" aria-label="Telecom e redes">
          <img src="assets/images/servico-telecom.jpg" alt="Telecom">
          <h3>Telecom</h3>
          <p>Redes estruturadas e cabeamento para garantir conectividade confiável.</p>
          <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Telecom">Orçar no WhatsApp</a>
        </article>
      </div>

      <div class="indicators" data-indicators="primary-services" aria-hidden="false"></div>
    </div>
  </section>

  <!-- Carousel 2: Categorias (each category card links to detailed section) -->
  <section class="section" aria-label="Categorias rápidas">
    <h2 class="category-title">Categorias</h2>
    <p class="lead">Escolha a categoria para ver os serviços mais procurados dentro dela.</p>

    <div class="carousel" data-speed="30" aria-roledescription="carousel" aria-label="Categorias">
      <div class="controls" aria-hidden="true">
        <button class="ctrl prev" data-target="categories" aria-label="Anterior">‹</button>
        <button class="ctrl next" data-target="categories" aria-label="Próximo">›</button>
      </div>

      <div class="track" data-track="categories" role="list">
        <article class="card" role="group" aria-label="Elétrica">
          <img src="assets/images/servico-eletrica.jpg" alt="Elétrica">
          <h3>Elétrica</h3>
          <p>Quadros, redistribuição, correções e iluminação. <a class="btn alt" href="#eletrica" style="margin-top:10px">Ver</a></p>
        </article>

        <article class="card" role="group" aria-label="CFTV">
          <img src="assets/images/servico-cftv.jpg" alt="CFTV">
          <h3>CFTV</h3>
          <p>Instalação de câmeras, gravação e acesso remoto. <a class="btn alt" href="#cftv" style="margin-top:10px">Ver</a></p>
        </article>

        <article class="card" role="group" aria-label="Telecom">
          <img src="assets/images/servico-telecom.jpg" alt="Telecom">
          <h3>Telecom</h3>
          <p>Cabeamento, pontos de rede e otimização. <a class="btn alt" href="#telecom" style="margin-top:10px">Ver</a></p>
        </article>

        <article class="card" role="group" aria-label="Automação">
          <img src="assets/images/servico-automacao.jpg" alt="Automação">
          <h3>Automação</h3>
          <p>Controles, cenários e integração. <a class="btn alt" href="#automacao" style="margin-top:10px">Ver</a></p>
        </article>

        <article class="card" role="group" aria-label="Ar condicionado">
          <img src="assets/images/servico-predial.webp" alt="Ar Condicionado">
          <h3>Ar Condicionado</h3>
          <p>Instalação, carga e manutenção. <a class="btn alt" href="#ar-condicionado" style="margin-top:10px">Ver</a></p>
        </article>

        <article class="card" role="group" aria-label="Marido de Aluguel">
          <img src="assets/images/servico-manut.jpeg" alt="Marido de aluguel">
          <h3>Marido de Aluguel</h3>
          <p>Pequenos reparos rápidos. <a class="btn alt" href="#marido" style="margin-top:10px">Ver</a></p>
        </article>
      </div>

      <div class="indicators" data-indicators="categories" aria-hidden="false"></div>
    </div>
  </section>

  <!-- Detailed categories: each with 3 most-searched services + "Outros serviços" -->
  <section class="section" aria-label="Instalações Técnicas e subcategorias">
    <h2 class="category-title">Instalações Técnicas</h2>
    <p class="lead">Serviços por categoria — os 3 itens mais procurados (baseado em termos de busca locais) + outros serviços.</p>

    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px;margin-top:18px">

      <!-- Elétrica -->
      <div id="eletrica" style="background:var(--card);padding:16px;border-radius:10px;text-align:left">
        <h3 style="color:var(--gold);margin-top:0">Elétrica</h3>
        <ul style="color:var(--muted);margin:8px 0 12px;padding-left:18px;line-height:1.4">
          <li><strong>Reforma elétrica</strong> — atualização de circuitos e quadros para segurança.</li>
          <li><strong>Instalação de quadro e disjuntores</strong> — proteção adequada e distribuição.</li>
          <li><strong>Aterramento e SPDA</strong> — proteção contra surtos e segurança elétrica.</li>
        </ul>
        <p style="color:var(--muted);margin:0 0 10px">Outros serviços: iluminação, tomadas, correções pontuais.</p>
        <a class="btn" href="https://wa.me/5511952544885?text=Orçar+serviço+Elétrica">Orçar</a>
      </div>

      <!-- CFTV -->
      <div id="cftv" style="background:var(--card);padding:16px;border-radius:10px;text-align:left">
        <h3 style="color:var(--gold);margin-top:0">CFTV</h3>
        <ul style="color:var(--muted);margin:8px 0 12px;padding-left:18px;line-height:1.4">
          <li><strong>Instalação de câmera IP</strong> — visão remota e gravação em NVR.</li>
          <li><strong>Projeto de cobertura</strong> — posicionamento para eliminar pontos cegos.</li>
          <li><strong>Manutenção e ajuste</strong> — foco, gravação e armazenamento.</li>
        </ul>
        <p style="color:var(--muted);margin:0 0 10px">Outros serviços: cabeamento, integração com alarmes.</p>
        <a class="btn" href="https://wa.me/5511952544885?text=Orçar+serviço+CFTV">Orçar</a>
      </div>

      <!-- Telecom -->
      <div id="telecom" style="background:var(--card);padding:16px;border-radius:10px;text-align:left">
        <h3 style="color:var(--gold);margin-top:0">Telecom</h3>
        <ul style="color:var(--muted);margin:8px 0 12px;padding-left:18px;line-height:1.4">
          <li><strong>Instalação de pontos de rede</strong> — cabeamento Cat5e/6 com certificação.</li>
          <li><strong>Rede estruturada</strong> — backbone, roteamento e segmentação.</li>
          <li><strong>Configuração de roteadores</strong> — QoS e VPN para empresas.</li>
        </ul>
        <p style="color:var(--muted);margin:0 0 10px">Outros serviços: Wi‑Fi enterprise, fibra interna.</p>
        <a class="btn" href="https://wa.me/5511952544885?text=Orçar+serviço+Telecom">Orçar</a>
      </div>

      <!-- Automação -->
      <div id="automacao" style="background:var(--card);padding:16px;border-radius:10px;text-align:left">
        <h3 style="color:var(--gold);margin-top:0">Automação</h3>
        <ul style="color:var(--muted);margin:8px 0 12px;padding-left:18px;line-height:1.4">
          <li><strong>Automação residencial</strong> — controle de iluminação e cenas.</li>
          <li><strong>Integração</strong> — integração com assistentes e controle remoto.</li>
          <li><strong>Centrais e cenários</strong> — programação e testes funcionais.</li>
        </ul>
        <p style="color:var(--muted);margin:0 0 10px">Outros serviços: sensores, programação avançada.</p>
        <a class="btn" href="https://wa.me/5511952544885?text=Orçar+serviço+Automação">Orçar</a>
      </div>

      <!-- Ar Condicionado -->
      <div id="ar-condicionado" style="background:var(--card);padding:16px;border-radius:10px;text-align:left">
        <h3 style="color:var(--gold);margin-top:0">Ar Condicionado</h3>
        <ul style="color:var(--muted);margin:8px 0 12px;padding-left:18px;line-height:1.4">
          <li><strong>Instalação de Split</strong> — montagem, dreno e fixação correta.</li>
          <li><strong>Limpeza e manutenção</strong> — filtros, serpentinas e inspeção.</li>
          <li><strong>Recarga de gás</strong> — diagnóstico e reposição conforme fabricante.</li>
        </ul>
        <p style="color:var(--muted);margin:0 0 10px">Outros serviços: migração de condensadora, balanceamento.</p>
        <a class="btn" href="https://wa.me/5511952544885?text=Orçar+serviço+Ar+Condicionado">Orçar</a>
      </div>

      <!-- Manutenção Geral -->
      <div id="manutencao-geral" style="background:var(--card);padding:16px;border-radius:10px;text-align:left">
        <h3 style="color:var(--gold);margin-top:0">Manutenção Geral</h3>
        <ul style="color:var(--muted);margin:8px 0 12px;padding-left:18px;line-height:1.4">
          <li><strong>Preventiva</strong> — inspeções periódicas e checklist técnico.</li>
          <li><strong>Corretiva</strong> — diagnóstico e solução de falhas.</li>
          <li><strong>Plano para condomínios</strong> — contratos e atendimentos programados.</li>
        </ul>
        <p style="color:var(--muted);margin:0 0 10px">Outros serviços: auditoria técnica e laudos.</p>
        <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Manutenção+Geral">Orçar</a>
      </div>

      <!-- Marido de Aluguel -->
      <div id="marido" style="background:var(--card);padding:16px;border-radius:10px;text-align:left">
        <h3 style="color:var(--gold);margin-top:0">Marido de Aluguel</h3>
        <ul style="color:var(--muted);margin:8px 0 12px;padding-left:18px;line-height:1.4">
          <li><strong>Montagem de móveis</strong> — montagem e ajustes rápidos.</li>
          <li><strong>Reparo hidráulico simples</strong> — trocas de vedação e conexões.</li>
          <li><strong>Elétrica básica</strong> — troca de tomadas e interruptores.</li>
        </ul>
        <p style="color:var(--muted);margin:0 0 10px">Outros serviços: pequenas instalações e ajustes.</p>
        <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Marido+de+Aluguel">Orçar</a>
      </div>

    </div>
  </section>

  <!-- Depoimentos -->
  <section class="section" aria-label="Depoimentos">
    <h2 class="category-title">Depoimentos</h2>
    <p class="lead">O que nossos clientes dizem — feedbacks reais sobre atendimento e qualidade.</p>

    <div class="testimonials" role="list" aria-live="polite">
      <div class="testimonial" role="listitem">"Agendamento rápido e serviço muito profissional. Resolveram a instalação do nosso prédio sem dor de cabeça." — Condomínio Alpha</div>
      <div class="testimonial" role="listitem">"Equipe atenciosa e entregou a automação conforme combinado. Recomendo." — Cliente Residencial</div>
      <div class="testimonial" role="listitem">"Orçamento claro e execução eficiente. Técnico pontual e organizado." — Loja Beta</div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div style="max-width:var(--maxw);margin:0 auto;padding:20px;color:var(--muted)">
      © 2025 Patronos Tech • WhatsApp: (11) 95254-4885
    </div>
  </footer>
</main>

<script>
/* Side menu open/close + focus management (same behavior as index) */
(function(){
  const menuBtn = document.getElementById('menuBtn');
  const menu = document.getElementById('sideMenu');
  const closeLink = document.getElementById('closeMenu');
  function open(){ menu.classList.add('open'); menu.setAttribute('aria-hidden','false'); menuBtn.setAttribute('aria-expanded','true'); document.body.style.overflow='hidden'; menu.querySelector('a:not(#closeMenu)')?.focus(); }
  function close(){ menu.classList.remove('open'); menu.setAttribute('aria-hidden','true'); menuBtn.setAttribute('aria-expanded','false'); document.body.style.overflow=''; menuBtn.focus(); }
  menuBtn.addEventListener('click', ()=> menu.classList.contains('open') ? close() : open());
  closeLink.addEventListener('click', close);
  menu.querySelectorAll('a').forEach(a=>a.addEventListener('click', close));
  document.addEventListener('keydown', e => { if(e.key === 'Escape' && menu.classList.contains('open')) close(); });
})();

/* Smooth anchor/navigation handling:
   - If link target is local anchor on this page -> smooth scroll
   - If link points to products.html with hash and user is on products.html -> smooth scroll without reload
   - Otherwise allow navigation
*/
(function(){
  function sameFile(a,b){
    const x = a.split('/').pop()||'';
    const y = b.split('/').pop()||'';
    return x === y || (x === '' && y === 'index.html') || (y === '' && x === 'index.html');
  }

  document.addEventListener('click', function(e){
    const a = e.target.closest('a');
    if(!a) return;
    const href = a.getAttribute('href');
    if(!href) return;
    if(href.startsWith('https://wa.me') || href.startsWith('mailto:') || href.startsWith('tel:')) return;
    const url = new URL(href, window.location.href);
    const path = url.pathname;
    const hash = url.hash;

    if(hash && (path === window.location.pathname || path === '' || sameFile(path, window.location.pathname))){
      e.preventDefault();
      const id = hash.substring(1);
      const el = document.getElementById(id);
      if(el) el.scrollIntoView({behavior:'smooth', block:'start'});
      try { history.replaceState(null,'',hash); } catch(err){}
      return;
    }
    // otherwise standard navigation
  }, {passive:false});
})();

/* Carousel Core - robust continuous loop with clones, drag, momentum, pause on hover/touch
   Reused and tuned for this page (same approach as index).
*/
(function(){
  const carousels = Array.from(document.querySelectorAll('.carousel'));
  if(!carousels.length) return;

  carousels.forEach(initCarousel);

  function initCarousel(car){
    const track = car.querySelector('.track');
    if(!track) return;
    const container = track.parentElement;
    const originals = Array.from(track.children);
    if(!originals.length) return;

    const prevBtn = car.querySelector('.prev');
    const nextBtn = car.querySelector('.next');
    const indicatorsRoot = car.querySelector('.indicators');

    const gap = parseFloat(getComputedStyle(track).gap) || 0;
    const speed = Math.max(10, parseFloat(car.getAttribute('data-speed')) || 36);
    let origSetWidth = 0;
    let itemWidth = 0;

    function measure(){
      origSetWidth = 0; itemWidth = 0;
      originals.forEach((el,idx)=>{ const w = el.offsetWidth + gap; origSetWidth += w; if(idx===0) itemWidth = w; });
    }

    function cloneUntil(){
      measure();
      let total = track.scrollWidth;
      const contW = container.offsetWidth;
      let safety = 0;
      while(total < contW * 2 && safety < 60){
        for(let i=0;i<originals.length && total < contW * 2;i++){
          const c = originals[i].cloneNode(true);
          c.setAttribute('aria-hidden','true');
          track.appendChild(c);
          total += originals[i].offsetWidth + gap;
        }
        safety++;
      }
      if(track.scrollWidth < origSetWidth * 2){
        originals.forEach(o=>{ const c = o.cloneNode(true); c.setAttribute('aria-hidden','true'); track.appendChild(c); });
      }
    }

    let pos = 0, last = null, raf = null, playing = true;
    let drag = {active:false,lastX:0,lastTime:0,velocity:0};

    function wrap(){
      const wrapAt = origSetWidth || (track.scrollWidth/2);
      if(!wrapAt) return;
      if(pos <= -wrapAt) pos += wrapAt;
      if(pos > 0) pos -= wrapAt;
    }

    function step(ts){
      if(!last) last = ts;
      const dt = (ts - last)/1000; last = ts;
      if(playing && !drag.active) pos -= speed * dt;
      wrap();
      track.style.transform = `translateX(${pos}px)`;
      raf = requestAnimationFrame(step);
    }

    function down(e){ drag.active = true; drag.lastX = e.touches ? e.touches[0].clientX : e.clientX; drag.lastTime = performance.now(); drag.velocity = 0; playing=false; }
    function move(e){ if(!drag.active) return; const now = performance.now(); const clientX = e.touches ? e.touches[0].clientX : e.clientX; const dx = clientX - drag.lastX; const dt = Math.max(1, now - drag.lastTime); const inst = (dx/dt)*1000; drag.velocity = drag.velocity*0.75 + inst*0.25; drag.lastX = clientX; drag.lastTime = now; pos += dx; track.style.transform = `translateX(${pos}px)`; }
    function up(){ if(!drag.active) return; drag.active=false; const v0 = drag.velocity||0; if(Math.abs(v0) < 30){ playing=true; last=null; return; } let v=v0; let t0 = performance.now(); function inertia(t){ const dt=(t-t0)/1000; t0=t; pos += v*dt; v *= Math.pow(0.92, dt*60); wrap(); track.style.transform = `translateX(${pos}px)`; if(Math.abs(v) < 10){ playing=true; last=null; return;} requestAnimationFrame(inertia); } requestAnimationFrame(inertia); }

    function arrow(dir){ const w = itemWidth || (originals[0].offsetWidth + gap) || 260; pos += (dir==='prev') ? w : -w; playing=false; track.style.transform = `translateX(${pos}px)`; setTimeout(()=>{ playing=true; last=null; }, 260); }

    function buildIndicators(){
      if(!indicatorsRoot) return;
      indicatorsRoot.innerHTML = '';
      const count = originals.length;
      for(let i=0;i<count;i++){
        const b = document.createElement('button');
        b.setAttribute('aria-label', `Ir para ${i+1}`);
        if(i===0) b.classList.add('active');
        b.addEventListener('click', ()=>{ const w = itemWidth || (originals[0].offsetWidth + gap); pos = -(i*w); wrap(); track.style.transform = `translateX(${pos}px)`; Array.from(indicatorsRoot.children).forEach(x=>x.classList.remove('active')); b.classList.add('active'); });
        indicatorsRoot.appendChild(b);
      }
    }

    function updateIndicators(){
      if(!indicatorsRoot) return;
      const buttons = Array.from(indicatorsRoot.children); if(!buttons.length) return;
      const w = itemWidth || (originals[0].offsetWidth + gap);
      const wrapAt = origSetWidth || (track.scrollWidth/2);
      let norm = pos % wrapAt; if(norm>0) norm -= wrapAt;
      const idx = Math.round(Math.abs(norm)/w) % originals.length;
      buttons.forEach((b,i)=> b.classList.toggle('active', i===idx));
    }

    function init(){
      measure(); cloneUntil(); buildIndicators();
      if(raf) cancelAnimationFrame(raf);
      last=null; raf = requestAnimationFrame(step);
      const cont = container;
      cont.addEventListener('mouseenter', ()=> playing=false);
      cont.addEventListener('mouseleave', ()=> { playing=true; last=null; });
      cont.addEventListener('touchstart', (e)=>{ down(e); playing=false; }, {passive:true});
      cont.addEventListener('touchmove', (e)=>{ move(e); }, {passive:false});
      cont.addEventListener('touchend', up);
      cont.addEventListener('pointerdown', (e)=>{ down(e); try{ cont.setPointerCapture && cont.setPointerCapture(e.pointerId); }catch(_){} }, false);
      window.addEventListener('pointermove', move);
      window.addEventListener('pointerup', up);
      if(prevBtn) prevBtn.addEventListener('click', ()=> arrow('prev'));
      if(nextBtn) nextBtn.addEventListener('click', ()=> arrow('next'));
      let rt; window.addEventListener('resize', ()=>{ clearTimeout(rt); rt = setTimeout(()=>{ measure(); cloneUntil(); buildIndicators(); }, 260); });
      setInterval(updateIndicators, 220);
    }

    // wait images
    const imgs = Array.from(track.querySelectorAll('img'));
    const unloaded = imgs.filter(i=>!i.complete);
    if(unloaded.length){
      let c=0; unloaded.forEach(img=> img.addEventListener('load', ()=>{ c++; if(c===unloaded.length) setTimeout(init,60); }));
      setTimeout(()=>{ if(!raf) init(); }, 1000);
    } else { setTimeout(init, 60); }
  }
})();
</script>

</body>
</html>
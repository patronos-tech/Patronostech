<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Patronos Tech • Produtos (Serviços Executados)</title>

<!-- Font + Preload hero -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<link rel="preload" as="image" href="assets/images/hero-eletrica.png">

<style>
:root{
  --bg-1:#071226;
  --card:#0b1320;
  --gold:#d4af37;
  --muted:#c8cad0;
  --white:#fff;
  --maxw:1120px;
  --radius:12px;
  --gap:18px;
  --shadow:0 12px 36px rgba(0,0,0,.55);
}

/* Reset / Base */
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:Poppins,system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;background:linear-gradient(180deg,var(--bg-1),#03121b);color:var(--white);-webkit-font-smoothing:antialiased}
.container{max-width:var(--maxw);margin:0 auto;padding:0 18px 48px}

/* Header */
header{position:sticky;top:0;background:rgba(2,6,12,.85);backdrop-filter:saturate(.9) blur(6px);z-index:120;padding:10px 0}
.header-inner{display:flex;align-items:center;justify-content:space-between;gap:12px}
.logo{font-weight:800;font-size:22px;background:linear-gradient(90deg,#fff,var(--gold));-webkit-background-clip:text;color:transparent}
.menu-btn{font-size:26px;background:transparent;border:0;color:var(--muted);padding:8px;border-radius:8px;cursor:pointer}
.menu-btn:focus{outline:2px solid rgba(212,175,55,.18);outline-offset:3px}

/* Side menu (unified sequence) */
#sideMenu{position:fixed;top:0;right:0;width:320px;max-width:86%;height:100%;background:#02061a;padding:18px;transform:translateX(100%);transition:transform .32s ease;box-shadow:-10px 0 40px rgba(0,0,0,.6);z-index:999}
#sideMenu.open{transform:translateX(0)}
#sideMenu a{display:block;color:var(--muted);padding:12px 0;text-decoration:none;border-bottom:1px solid rgba(255,255,255,.03)}
#sideMenu a:first-child{ text-align:right }

/* HERO - aligned with Home but using "Produtos" title */
.hero{position:relative;margin-top:14px;border-radius:10px;overflow:hidden}
.hero img{width:100%;height:min(58vh,540px);object-fit:cover;object-position:center center;display:block}
.hero-overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:28px;background:linear-gradient(180deg, rgba(2,8,18,0.18), rgba(2,8,18,0.52));}
.hero-content{max-width:980px;width:100%;padding:10px 18px;text-align:center}
.hero h1{margin:0;font-size:1.7rem;line-height:1.05;font-weight:700;color:var(--white);text-shadow:0 6px 20px rgba(0,0,0,.45)}
.hero .lead{margin-top:10px;color:rgba(255,255,255,.9);font-size:1rem;max-width:72ch;margin-left:auto;margin-right:auto}
.hero-ctas{margin-top:16px;display:flex;gap:12px;flex-wrap:wrap;justify-content:center}
.btn{display:inline-block;padding:10px 16px;border-radius:10px;background:var(--gold);color:#000;font-weight:700;text-decoration:none}
.btn.alt{background:transparent;border:1px solid rgba(212,175,55,.12);color:var(--gold)}

/* Page sections */
.section{padding:40px 0}
.section h2{text-align:center;color:var(--gold);margin:0 0 8px;font-size:1.15rem}
.section p.lead{max-width:980px;margin:8px auto 22px;text-align:center;color:var(--muted);font-size:1rem}

/* Carousel shared styles */
.carousel{position:relative;overflow:hidden;margin:8px 0;padding:8px 0}
.track{display:flex;gap:var(--gap);align-items:stretch;will-change:transform;padding:8px}
.card{background:var(--card);border-radius:12px;padding:14px;min-width:260px;flex:0 0 260px;box-shadow:var(--shadow);display:flex;flex-direction:column;align-items:center;text-align:center}
.card img{width:100%;height:150px;object-fit:cover;border-radius:8px}
.card h3{margin:12px 0 8px;color:var(--gold);font-size:1.05rem}
.card p{margin:0;color:var(--muted);font-size:0.95rem;line-height:1.35}

/* product/service card specifics */
.prod-card{min-width:220px;flex:0 0 220px}
.prod-card .price{color:var(--gold);font-weight:700;margin-top:8px}

/* category card */
.cat-card{min-width:180px;flex:0 0 180px;align-items:center;text-align:center;padding:12px}
.cat-card img{height:110px;width:100%;object-fit:cover;border-radius:10px;margin-bottom:8px}

/* Controls & indicators */
.controls{position:absolute;top:50%;left:6px;right:6px;display:flex;justify-content:space-between;transform:translateY(-50%);pointer-events:none}
.ctrl{pointer-events:auto;background:rgba(0,0,0,.36);border:0;color:var(--white);width:44px;height:44px;border-radius:8px;display:flex;align-items:center;justify-content:center;cursor:pointer}
.ctrl:focus{outline:2px solid rgba(212,175,55,.18)}
.indicators{display:flex;gap:8px;justify-content:center;margin-top:10px}
.indicators button{width:10px;height:10px;border-radius:50%;border:0;background:rgba(255,255,255,.12);cursor:pointer}
.indicators button.active{background:var(--gold)}

/* Hierarchy enforce: page title > category title > card title > description */
.page-title{font-size:1.7rem}
.category-title{font-size:1.25rem}
.card-title{font-size:1.05rem}
.card-desc{font-size:0.95rem}

/* Misc */
.features{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin-top:8px}
.feature{background:var(--card);padding:16px;border-radius:10px;text-align:center}
.institutional{background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);padding:18px;border-radius:12px;margin-top:8px}
.form-card{background:var(--card);padding:18px;border-radius:12px;box-shadow:var(--shadow);margin-top:6px}

/* Responsive */
@media (max-width:900px){
  .card{min-width:220px;flex:0 0 220px}
  .prod-card{min-width:200px;flex:0 0 200px}
  .hero h1{font-size:1.35rem}
}
@media (max-width:600px){
  .container{padding:0 14px 48px}
  .card{min-width:86vw;flex:0 0 86vw;border-radius:10px}
  .prod-card{min-width:70vw;flex:0 0 70vw}
  .cat-card{min-width:54vw;flex:0 0 54vw}
  .controls{display:none}
  .hero h1{font-size:1.05rem}
}
</style>
</head>
<body>

<header>
  <div class="container header-inner">
    <div class="logo">Patronos Tech</div>
    <button id="menuBtn" class="menu-btn" aria-controls="sideMenu" aria-expanded="false" aria-label="Abrir menu">☰</button>
  </div>
</header>

<nav id="sideMenu" aria-hidden="true" aria-label="Menu lateral">
  <a id="closeMenu" href="javascript:void(0)">✕ Fechar</a>

  <!-- Unified menu sequence (matches index.html menu) -->
  <a href="products.html">Serviços</a>
  <a href="index.html#servicos-tecnicos">Serviços Técnicos</a>
  <a href="products.html#eletrica">Elétrica</a>
  <a href="products.html#cftv">CFTV</a>
  <a href="products.html#telecom">Telecom</a>
  <a href="products.html#automacao">Automação</a>
  <a href="products.html#manutencao-geral">Manutenção Geral</a>
  <a href="products.html#marido">Marido de aluguel</a>
  <a href="parcerias.html">Parcerias</a>
  <a href="https://wa.me/5511952544885">Contatos</a>
</nav>

<main class="container">

  <!-- HERO -->
  <section class="hero" aria-label="Hero produtos">
    <img src="assets/images/hero-eletrica.png" alt="Técnico realizando instalação">
    <div class="hero-overlay" role="region" aria-label="Hero - Produtos">
      <div class="hero-content">
        <h1 class="page-title">Produtos</h1>
        <div class="lead">Serviços executados e procedimentos — descrição clara do que fazemos e como resolvemos o seu problema.</div>
        <div class="hero-ctas">
          <a class="btn" href="https://wa.me/5511952544885?text=Olá,+gostaria+de+um+orçamento">Orçar agora (WhatsApp)</a>
          <a class="btn alt" href="#servicos-executados">Ver serviços</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Carrossel 1: Serviços Principais (3 cards) -->
  <section class="section" id="servicos-principais" aria-label="Serviços Principais">
    <h2 class="category-title">Serviços Principais</h2>
    <p class="lead">Destaques: os três tipos de serviço que resolvem a maior parte dos problemas dos nossos clientes.</p>

    <div class="carousel" data-speed="36" aria-roledescription="carousel" aria-label="Serviços Principais">
      <div class="controls" aria-hidden="true">
        <button class="ctrl prev" data-target="main-services" aria-label="Anterior">‹</button>
        <button class="ctrl next" data-target="main-services" aria-label="Próximo">›</button>
      </div>

      <div class="track" data-track="main-services" role="list">
        <article class="card" role="group" aria-label="Instalações Técnicas">
          <img src="assets/images/servico-eletrica.jpg" alt="Instalações Técnicas">
          <h3 class="card-title">Instalações Técnicas</h3>
          <p class="card-desc">Execução de projetos elétricos, cabeamento e CFTV para residências e comércios — indicado para quem precisa de instalação conforme norma e documentação.</p>
          <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Instalações+Técnicas">Orçar no WhatsApp</a>
        </article>

        <article class="card" role="group" aria-label="Manutenção Geral">
          <img src="assets/images/servico-geral.jpeg" alt="Manutenção Geral">
          <h3 class="card-title">Manutenção Geral</h3>
          <p class="card-desc">Manutenção preventiva e corretiva para reduzir falhas e aumentar a vida útil de instalações — ideal para condomínios e empresas.</p>
          <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Manutenção+Geral">Orçar no WhatsApp</a>
        </article>

        <article class="card" role="group" aria-label="Marido de Aluguel">
          <img src="assets/images/servico-manut.jpeg" alt="Marido de Aluguel">
          <h3 class="card-title">Marido de Aluguel</h3>
          <p class="card-desc">Atendimentos rápidos para pequenos reparos e instalações domésticas — solução prática para problemas do dia a dia.</p>
          <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Marido+de+Aluguel">Orçar no WhatsApp</a>
        </article>
      </div>

      <div class="indicators" data-indicators="main-services" aria-hidden="false"></div>
    </div>
  </section>

  <!-- Carrossel 2: Serviços Executados (lista específica) -->
  <section class="section" id="servicos-executados" aria-label="Serviços Executados">
    <h2 class="category-title">Serviços Executados</h2>
    <p class="lead">Exemplos de serviços que realizamos no dia a dia — descrição curta, quem se beneficia e problema resolvido.</p>

    <div class="carousel" data-speed="50" aria-roledescription="carousel" aria-label="Serviços Executados">
      <div class="controls" aria-hidden="true">
        <button class="ctrl prev" data-target="executed-services" aria-label="Anterior">‹</button>
        <button class="ctrl next" data-target="executed-services" aria-label="Próximo">›</button>
      </div>

      <div class="track" data-track="executed-services" role="list">
        <article class="card prod-card" role="group" aria-label="Instalação de Chuveiro">
          <img src="assets/images/servico-manut.jpeg" alt="Instalação de Chuveiro">
          <h3 class="card-title">Instalação de Chuveiro</h3>
          <p class="card-desc">Instalação segura e testada de chuveiros elétricos ou a gás — para quem precisa de troca ou atualização sem risco elétrico.</p>
          <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Instalação+de+Chuveiro">Orçar no WhatsApp</a>
        </article>

        <article class="card prod-card" role="group" aria-label="Instalação de Torneira">
          <img src="assets/images/servico-agua.jpg" alt="Instalação de Torneira">
          <h3 class="card-title">Instalação de Torneira</h3>
          <p class="card-desc">Instalação e vedação profissional de torneiras e misturadores — indicado para evitar vazamentos e problemas hidráulicos.</p>
          <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Instalação+de+Torneira">Orçar no WhatsApp</a>
        </article>

        <article class="card prod-card" role="group" aria-label="Instalação de Câmeras">
          <img src="assets/images/servico-cftv.jpg" alt="Instalação de Câmeras">
          <h3 class="card-title">Instalação de Câmeras</h3>
          <p class="card-desc">Posicionamento e instalação com configuração de acesso remoto — ideal para quem busca vigilância confiável.</p>
          <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Instalação+de+Câmeras">Orçar no WhatsApp</a>
        </article>

        <article class="card prod-card" role="group" aria-label="Limpeza de Caixa d'Água">
          <img src="assets/images/servico-agua.jpg" alt="Limpeza de Caixa d'Água">
          <h3 class="card-title">Limpeza de Caixa d'Água</h3>
          <p class="card-desc">Limpeza técnica com procedimentos sanitários — indicado para residências e prédios que precisam de higiene e segurança da água.</p>
          <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Limpeza+de+Caixa+d'Água">Orçar no WhatsApp</a>
        </article>

        <article class="card prod-card" role="group" aria-label="Instalação de Suportes">
          <img src="assets/images/servico-suportes.jpg" alt="Instalação de Suportes">
          <h3 class="card-title">Instalação de Suportes</h3>
          <p class="card-desc">Fixação técnica para TVs, prateleiras e equipamentos com ancoragem correta — evita quedas e danos.</p>
          <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Instalação+de+Suportes">Orçar no WhatsApp</a>
        </article>

        <article class="card prod-card" role="group" aria-label="Troca de Lâmpadas e Pequenos Reparos">
          <img src="assets/images/servico-lampadas.jpg" alt="Troca de Lâmpadas">
          <h3 class="card-title">Troca de Lâmpadas & Pequenos Reparos</h3>
          <p class="card-desc">Serviços rápidos como troca de lâmpadas, ajustes e pequenos reparos — solução para quem precisa de atendimento imediato.</p>
          <a class="btn" href="https://wa.me/5511952544885?text=Orçar+Troca+de+Lâmpadas+e+Pequenos+Reparos">Orçar no WhatsApp</a>
        </article>
      </div>

      <div class="indicators" data-indicators="executed-services" aria-hidden="false"></div>
    </div>
  </section>

  <!-- Carrossel 3: Categorias -->
  <section class="section" id="categorias" aria-label="Categorias">
    <h2 class="category-title">Categorias</h2>
    <p class="lead">Navegue pelas categorias para encontrar os serviços adequados ao seu caso.</p>

    <div class="carousel" data-speed="28" aria-roledescription="carousel" aria-label="Categorias">
      <div class="controls" aria-hidden="true">
        <button class="ctrl prev" data-target="cats" aria-label="Anterior">‹</button>
        <button class="ctrl next" data-target="cats" aria-label="Próximo">›</button>
      </div>

      <div class="track" data-track="cats" role="list">
        <article class="card cat-card" role="group" aria-label="Elétrica">
          <img src="assets/images/servico-eletrica.jpg" alt="Elétrica">
          <h3 class="card-title">Elétrica</h3>
          <p class="card-desc">Rede elétrica, quadros e correções para segurança e conformidade.</p>
          <a class="btn" href="#eletrica">Ver categoria</a>
        </article>

        <article class="card cat-card" role="group" aria-label="CFTV">
          <img src="assets/images/servico-cftv.jpg" alt="CFTV">
          <h3 class="card-title">CFTV</h3>
          <p class="card-desc">Monitoramento por câmeras, gravação e acesso remoto.</p>
          <a class="btn" href="#cftv">Ver categoria</a>
        </article>

        <article class="card cat-card" role="group" aria-label="Telecom">
          <img src="assets/images/servico-telecom.jpg" alt="Telecom">
          <h3 class="card-title">Telecom</h3>
          <p class="card-desc">Cabeamento e redes para desempenho e estabilidade da conexão.</p>
          <a class="btn" href="#telecom">Ver categoria</a>
        </article>

        <article class="card cat-card" role="group" aria-label="Automação">
          <img src="assets/images/servico-automacao.jpg" alt="Automação">
          <h3 class="card-title">Automação</h3>
          <p class="card-desc">Integração e controle remoto para conforto e economia.</p>
          <a class="btn" href="#automacao">Ver categoria</a>
        </article>

        <article class="card cat-card" role="group" aria-label="Manutenção Predial">
          <img src="assets/images/servico-predial.webp" alt="Manutenção Predial">
          <h3 class="card-title">Manutenção Predial</h3>
          <p class="card-desc">Inspeções, correções e rotinas para prédios e condomínios.</p>
          <a class="btn" href="#predial">Ver categoria</a>
        </article>

        <article class="card cat-card" role="group" aria-label="Iluminação">
          <img src="assets/images/servico-lampadas.jpg" alt="Iluminação">
          <h3 class="card-title">Iluminação</h3>
          <p class="card-desc">Projetos luminotécnicos e soluções LED para eficiência energética.</p>
          <a class="btn" href="#iluminacao">Ver categoria</a>
        </article>

        <article class="card cat-card" role="group" aria-label="Marido de Aluguel">
          <img src="assets/images/servico-manut.jpeg" alt="Marido de Aluguel">
          <h3 class="card-title">Marido de Aluguel</h3>
          <p class="card-desc">Pequenos reparos e instalações para demandas imediatas.</p>
          <a class="btn" href="#marido">Ver categoria</a>
        </article>
      </div>

      <div class="indicators" data-indicators="cats" aria-hidden="false"></div>
    </div>
  </section>

  <!-- Seção 4: categorias detalhadas / subcategorias (IDs added for anchors) -->
  <section class="section" aria-label="Categorias detalhadas">
    <h2 class="category-title">Instalações Técnicas • Manutenção Geral • Marido de Aluguel</h2>
    <p class="lead">Mantemos todas as categorias validadas: Elétrica, CFTV, Telecom, Ar Condicionado, Automação e subserviços listados abaixo com descrições claras e CTAs.</p>

    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px;margin-top:18px">
      <div id="eletrica" style="background:var(--card);padding:14px;border-radius:10px;text-align:center">
        <h3 style="color:var(--gold);margin:8px 0">Elétrica</h3>
        <p style="color:var(--muted);margin:0 0 10px">Projetos, correções, quadros e iluminação com segurança normativa.</p>
        <a class="btn" href="https://wa.me/5511952544885?text=Orçar+serviço+Elétrica">Orçar</a>
      </div>

      <div id="cftv" style="background:var(--card);padding:14px;border-radius:10px;text-align:center">
        <h3 style="color:var(--gold);margin:8px 0">CFTV</h3>
        <p style="color:var(--muted);margin:0 0 10px">Instalação e manutenção de câmeras e gravação para controle e segurança.</p>
        <a class="btn" href="https://wa.me/5511952544885?text=Orçar+serviço+CFTV">Orçar</a>
      </div>

      <div id="telecom" style="background:var(--card);padding:14px;border-radius:10px;text-align:center">
        <h3 style="color:var(--gold);margin:8px 0">Telecom</h3>
        <p style="color:var(--muted);margin:0 0 10px">Redes estruturadas, cabeamento e otimização de conectividade.</p>
        <a class="btn" href="https://wa.me/5511952544885?text=Orçar+serviço+Telecom">Orçar</a>
      </div>

      <div id="automacao" style="background:var(--card);padding:14px;border-radius:10px;text-align:center">
        <h3 style="color:var(--gold);margin:8px 0">Automação</h3>
        <p style="color:var(--muted);margin:0 0 10px">Integração de sistemas, cenários e controles remotos.</p>
        <a class="btn" href="https://wa.me/5511952544885?text=Orçar+serviço+Automação">Orçar</a>
      </div>

      <div id="predial" style="background:var(--card);padding:14px;border-radius:10px;text-align:center">
        <h3 style="color:var(--gold);margin:8px 0">Manutenção Predial</h3>
        <p style="color:var(--muted);margin:0 0 10px">Inspeções, reformas e rotinas para prédios e condomínios.</p>
        <a class="btn" href="https://wa.me/5511952544885?text=Orçar+serviço+Predial">Orçar</a>
      </div>

      <div id="iluminacao" style="background:var(--card);padding:14px;border-radius:10px;text-align:center">
        <h3 style="color:var(--gold);margin:8px 0">Iluminação</h3>
        <p style="color:var(--muted);margin:0 0 10px">Projetos luminotécnicos e soluções LED para eficiência energética.</p>
        <a class="btn" href="https://wa.me/5511952544885?text=Orçar+serviço+Iluminação">Orçar</a>
      </div>

      <div id="marido" style="background:var(--card);padding:14px;border-radius:10px;text-align:center">
        <h3 style="color:var(--gold);margin:8px 0">Marido de Aluguel</h3>
        <p style="color:var(--muted);margin:0 0 10px">Pequenos reparos, ajustes e serviços pontuais com garantia.</p>
        <a class="btn" href="https://wa.me/5511952544885?text=Orçar+serviço+Marido+de+Aluguel">Orçar</a>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer style="margin-top:40px">
    <div style="max-width:var(--maxw);margin:0 auto;padding:20px;color:var(--muted)">
      © 2025 Patronos Tech • WhatsApp: (11) 95254-4885
    </div>
  </footer>
</main>

<script>
/* Side menu (open/close + focus management) */
(function(){
  const menuBtn = document.getElementById('menuBtn');
  const menu = document.getElementById('sideMenu');
  const closeLink = document.getElementById('closeMenu');
  function open(){ menu.classList.add('open'); menu.setAttribute('aria-hidden','false'); menuBtn.setAttribute('aria-expanded','true'); document.body.style.overflow='hidden'; menu.querySelector('a:not(#closeMenu)')?.focus(); }
  function close(){ menu.classList.remove('open'); menu.setAttribute('aria-hidden','true'); menuBtn.setAttribute('aria-expanded','false'); document.body.style.overflow=''; menuBtn.focus(); }
  menuBtn.addEventListener('click', ()=> menu.classList.contains('open') ? close() : open());
  closeLink.addEventListener('click', close);
  menu.querySelectorAll('a').forEach(a=>a.addEventListener('click', close));
  document.addEventListener('keydown', e => { if(e.key === 'Escape' && menu.classList.contains('open')) close(); });
})();

/* Smooth nav behavior: intercept menu links to avoid reload when target is same page.
   - If link points to products.html#... and current page is products.html -> smooth scroll to id
   - If link is a hash-only (e.g. #eletrica) -> smooth scroll in current page
   - Otherwise, allow normal navigation (index.html, parcerias.html, external)
*/
(function(){
  function isSamePath(pathA, pathB){
    const a = pathA.split('/').pop() || '';
    const b = pathB.split('/').pop() || '';
    return a === b || (a === '' && b === 'index.html') || (b === '' && a === 'index.html');
  }

  document.addEventListener('click', function(e){
    const el = e.target.closest('a');
    if(!el) return;
    const href = el.getAttribute('href');
    if(!href || href.startsWith('mailto:') || href.startsWith('tel:') || href.startsWith('https://wa.me')) return;
    const url = new URL(href, window.location.href);
    const targetPath = url.pathname;
    const targetHash = url.hash;

    // hash-only on this page or same-path + hash -> smooth scroll
    if((targetPath === window.location.pathname || targetPath === '' || isSamePath(targetPath, window.location.pathname)) && targetHash){
      e.preventDefault();
      const id = targetHash.substring(1);
      const targetEl = document.getElementById(id);
      if(targetEl){
        targetEl.scrollIntoView({behavior:'smooth', block:'start'});
        try { history.replaceState(null, '', targetHash); } catch(err){}
      }
      return;
    }
    // otherwise let navigation occur (different page)
  }, {passive:false});
})();

/* Carousel Core — robust infinite loop, drag, momentum, pause on hover/touch
   (same implementation used on home; reused here)
*/
(function(){
  const carousels = Array.from(document.querySelectorAll('.carousel'));
  if(!carousels.length) return;

  carousels.forEach(initCarousel);

  function initCarousel(car) {
    const track = car.querySelector('.track');
    if(!track) return;
    const container = track.parentElement;
    const originals = Array.from(track.children);
    if(!originals.length) return;

    const prevBtn = car.querySelector('.prev');
    const nextBtn = car.querySelector('.next');
    const indicatorsRoot = car.querySelector('.indicators');

    const gap = parseFloat(getComputedStyle(track).gap) || 0;
    const speed = Math.max(12, parseFloat(car.getAttribute('data-speed')) || 40); // px/sec
    let origSetWidth = 0;
    let itemWidth = 0;

    function measureOriginals(){
      origSetWidth = 0;
      itemWidth = 0;
      originals.forEach((el, idx) => {
        const w = el.offsetWidth + gap;
        origSetWidth += w;
        if(idx === 0) itemWidth = w;
      });
    }

    function addClonesUntilEnough(){
      measureOriginals();
      let total = track.scrollWidth;
      const contW = container.offsetWidth;
      let safety = 0;
      while(total < contW * 2 && safety < 60){
        for(let i=0;i<originals.length && total < contW * 2;i++){
          const clone = originals[i].cloneNode(true);
          clone.setAttribute('aria-hidden','true');
          track.appendChild(clone);
          total += originals[i].offsetWidth + gap;
        }
        safety++;
      }
      if(track.scrollWidth < origSetWidth * 2){
        originals.forEach(el=>{
          const clone = el.cloneNode(true);
          clone.setAttribute('aria-hidden','true');
          track.appendChild(clone);
        });
      }
    }

    let pos = 0;
    let lastTime = null;
    let raf = null;
    let playing = true;
    let drag = { active:false, lastX:0, lastTime:0, velocity:0 };

    function wrapPos(){
      const wrapAt = origSetWidth || (track.scrollWidth/2);
      if(!wrapAt) return;
      if(pos <= -wrapAt) pos += wrapAt;
      if(pos > 0) pos -= wrapAt;
    }

    function step(ts){
      if(!lastTime) lastTime = ts;
      const dt = (ts - lastTime)/1000;
      lastTime = ts;
      if(playing && !drag.active){
        pos -= speed * dt;
      }
      wrapPos();
      track.style.transform = `translateX(${pos}px)`;
      raf = requestAnimationFrame(step);
    }

    function down(e){
      drag.active = true;
      drag.lastX = e.touches ? e.touches[0].clientX : e.clientX;
      drag.lastTime = performance.now();
      drag.velocity = 0;
      playing = false;
    }
    function move(e){
      if(!drag.active) return;
      const now = performance.now();
      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const dx = clientX - drag.lastX;
      const dt = Math.max(1, now - drag.lastTime);
      const inst = (dx/dt)*1000;
      drag.velocity = drag.velocity*0.75 + inst*0.25;
      drag.lastX = clientX; drag.lastTime = now;
      pos += dx;
      track.style.transform = `translateX(${pos}px)`;
    }
    function up(){
      if(!drag.active) return;
      drag.active = false;
      const initialV = drag.velocity || 0;
      if(Math.abs(initialV) < 30){ playing = true; lastTime = null; return; }
      let v = initialV; let last = performance.now();
      function momentum(t){
        const dt = (t - last)/1000; last = t;
        pos += v * dt;
        v *= Math.pow(0.92, dt*60);
        wrapPos();
        track.style.transform = `translateX(${pos}px)`;
        if(Math.abs(v) < 10){ playing = true; lastTime = null; return; }
        requestAnimationFrame(momentum);
      }
      requestAnimationFrame(momentum);
    }

    function arrow(dir){
      const w = itemWidth || (originals[0].offsetWidth + gap) || 260;
      pos += (dir === 'prev') ? w : -w;
      playing = false;
      track.style.transform = `translateX(${pos}px)`;
      setTimeout(()=>{ playing = true; lastTime = null; }, 260);
    }

    function buildIndicators(){
      if(!indicatorsRoot) return;
      indicatorsRoot.innerHTML = '';
      const count = originals.length;
      for(let i=0;i<count;i++){
        const b = document.createElement('button');
        b.setAttribute('aria-label', `Ir para item ${i+1}`);
        if(i===0) b.classList.add('active');
        b.addEventListener('click', ()=>{
          const w = itemWidth || (originals[0].offsetWidth + gap);
          pos = -(i * w);
          wrapPos();
          track.style.transform = `translateX(${pos}px)`;
          Array.from(indicatorsRoot.children).forEach(x=>x.classList.remove('active'));
          b.classList.add('active');
        });
        indicatorsRoot.appendChild(b);
      }
    }

    function updateIndicators(){
      if(!indicatorsRoot) return;
      const buttons = Array.from(indicatorsRoot.children);
      if(!buttons.length) return;
      const w = itemWidth || (originals[0].offsetWidth + gap);
      const wrapAt = origSetWidth || (track.scrollWidth/2);
      let normalized = pos % wrapAt;
      if(normalized > 0) normalized -= wrapAt;
      const idx = Math.round(Math.abs(normalized) / w) % originals.length;
      buttons.forEach((b,i)=> b.classList.toggle('active', i===idx));
    }

    function initialize(){
      measureAndStart();
    }

    function measureAndStart(){
      // measure widths
      origSetWidth = 0; itemWidth = 0;
      originals.forEach((el, idx)=>{
        const w = el.offsetWidth + gap;
        origSetWidth += w;
        if(idx === 0) itemWidth = w;
      });
      addClonesUntilEnough();
      buildIndicators();
      if(raf) cancelAnimationFrame(raf);
      lastTime = null;
      raf = requestAnimationFrame(step);
      const containerElem = container;
      containerElem.addEventListener('mouseenter', ()=> playing = false);
      containerElem.addEventListener('mouseleave', ()=> { playing = true; lastTime = null; });
      containerElem.addEventListener('touchstart', (e)=> { down(e); playing = false; }, {passive:true});
      containerElem.addEventListener('touchmove', (e)=> { move(e); }, {passive:false});
      containerElem.addEventListener('touchend', up);
      containerElem.addEventListener('pointerdown', (e)=> { down(e); try{ containerElem.setPointerCapture && containerElem.setPointerCapture(e.pointerId); } catch(e){} }, false);
      window.addEventListener('pointermove', move);
      window.addEventListener('pointerup', up);

      if(prevBtn) prevBtn.addEventListener('click', ()=> arrow('prev'));
      if(nextBtn) nextBtn.addEventListener('click', ()=> arrow('next'));

      let resizeTimer;
      window.addEventListener('resize', ()=>{
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(()=>{ measureOriginals(); addClonesUntilEnough(); buildIndicators(); }, 240);
      });

      setInterval(updateIndicators, 220);
    }

    // wait images loaded
    const imgs = Array.from(track.querySelectorAll('img'));
    const unloaded = imgs.filter(i=>!i.complete);
    if(unloaded.length){
      let loaded = 0;
      unloaded.forEach(img => img.addEventListener('load', ()=>{ loaded++; if(loaded === unloaded.length) setTimeout(initialize, 60); }));
      setTimeout(()=>{ if(!raf) initialize(); }, 800);
    } else {
      setTimeout(initialize, 60);
    }

    function measureOriginals(){
      origSetWidth = 0; itemWidth = 0;
      originals.forEach((el, idx)=> {
        const w = el.offsetWidth + gap;
        origSetWidth += w;
        if(idx === 0) itemWidth = w;
      });
    }
  }
})();
</script>

</body>
</html>